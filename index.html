<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8"/>
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"/>

	<title>xtpl — больше, чем JavaScript шаблонизатор</title>

	<meta name="keywords"
		  content="xtpl, javascript, template, nodejs, browser, server, client, binding, data-binding, MVVM, rubaxa"/>

	<meta name="description"
		  content="xtpl — JavaScript шаблонизатор нового поколения, работает как на клиенте, так и сервере.
		           Позволяет связывать данные с шаблоном и многое другое."/>



	<link rel="stylesheet" href="http://designmodo.github.io/Flat-UI/bootstrap/css/bootstrap.css" />
	<link href='http://fonts.googleapis.com/css?family=Wire+One' rel='stylesheet' type='text/css'>

	<style>
		body {
			color: #383e4b;
			background-color: #f5f5f5;
			min-width: 800px;
		}

		h1.main {
			margin: 150px 0;
			text-align: center;
			font-size: 100px;
			font-family: 'Wire One', sans-serif;

		}

		.container-fluid-full {
			height: 100%;
			position: relative;
		}

		#sidebar-left {
			color: #fff;
			height: 100%;
			position: absolute;
			font-size: 14px;
			font-family: Lato, sans-serif;
			background-color: rgb(56, 62, 75);
		}
			#sidebar-left a {
				color: #fff;
				border: 0;
				border-radius: 0;
				background-color: transparent;
			}
				#sidebar-left a:hover,
				#sidebar-left .active a {
					background-color: rgb(45, 50, 61);
				}


		#content {
			width: 85%;
			margin: 0 auto;
			padding: 0 20px;
		}

		.well {
			border: 0;
			padding: 15px 20px;
			border-radius: 3px;
			box-shadow: 0 1px 0 1px #e4e6eb;
			background-color: #fff;
		}

		.btn.xlarge {
			font-size: 30px;
			padding-left: 30px;
			padding-right: 30px;
		}

		.code-node { color: #006; }
		.code-class { color: #060; }
		.code-prop { color: #800080; }
		.code-xprop { color: #800080; font-style: italic; }
		.code-str { color: #060; }

		.well {
			max-height: 300px;
			overflow: auto;
		}
	</style>
</head>
<body>
	<script x-ctrl="main" type="text/xtpl">
		// Main Page
		.container-fluid-full {
			.row-fluid {
				// Page content
				div#content {
					h1.main | Simple. Easy. Quickly.

					// "Hello"
					.row-fluid {
						.span7.well | {*ctx.examples.hello.xtpl | xcode*}

						.span5.well {
						   h4 | Hello {{ctx.name || "%username%"}}!
						   input { type: "text", x-model: ctx.name }
						}
					}

					// "Counter"
					.row-fluid {
						.span7.well | {*ctx.examples.counter.xtpl | xcode*}

						.span5.well[style="text-align: center"] {
							input.btn.btn-success.xlarge[type="button"] {
								x-click: ctx.examples.counter.ctx.cnt++;
								value: ctx.examples.counter.ctx.cnt || "Click me"
							}
						}
					}

					// "List"
					.row-fluid {
						.span7.well | {*ctx.examples.list.xtpl | xcode*}

						.span5.well[x-ctrl="list"] {
							form {
								x-submit: ctx.addItem(ctx.newItem);
								input[type="text"][placeholder="Add new item"] {
									x-model: ctx.newItem
									x-autofocus: ctx.newItem === ""
								}
							}

							ul.nav.nav-pills.nav-stacked {
								for item in ctx.items {
									li {
										x-click: ctx.selectedItem = item;
										class: { active: item === ctx.selectedItem }
										a[href=""] | {{item}}
									}
								}
							}

							div {
								button.btn.btn-small {
									x-click: ctx.sortItems(ctx.SORT_ASC);
									| asc
								}

								| &nbsp; &nbsp;

								button.btn.btn-small {
									x-click: ctx.sortItems(ctx.SORT_DESC);
									| desc
								}
							}
						}
					}
				}
			}
		}
	</script>



		<!--script type="text/xtpl">
			div.well {
				label | Name:
				input[type="text"][placeholder="Enter a name here"] { x-model: ctx.yourName }
				hr {}
				h1 | Hello {{ctx.yourName}}
			}
		</script-->


		<!--script x-ctrl="todos" type="text/xtpl">
		h2 | Todos
		div {
			span | {{ctx.remaining()}} of {{ctx.todos.length}} remaining |

			| [ |
			a[href=""] {
				x-click: ctx.archive()
				| archive
			}
			| ] |

			ul.unstyled {
				for todo in todos {
					li {
						input[type="checkbox"] { x-model: todo.done }
						span[class="done-{{todo.done}}"] | {{todo.text}}
					}
				}
			}

			form {
				x-submit: ctx.addTodo()
				input[type="text"][size="30"][placeholder="add new todo here"] { x-model: ctx.todoText }
				input.btn-primary[type="submit"][value="add"]
			}
		}
	</script-->


	<script src="/js/xtpl.min.js"></script>
	<script>
		xtpl.ctrl('main', function (ctx){
			xtpl.mod('xcode', function (code){
				code	= code.split('\n');
				xtpl.utils.each(code, function (line, i){
					code[i] = line
						.replace(/(\|[^$]+)/, function (_, val){
							return val.replace(/&/g, '&amp;').replace(/"/g, '&quot;');
						})
						.replace(/(".*?")/g, '<span class="code-str">$1</span>')
						.replace(/^(\s*)(\w+)([.\s#\[])/g, '$1<span class="code-node">$2</span>$3')
						.replace(/((?:^\s*|>)\.)([.\w-]+)/g, '$1<span class="code-class">$2</span>')
						.replace(/(\s)(x-\w+:)/g, '$1<span class="code-xprop">$2</span>')
						.replace(/(\s)(\w+:)/g, '$1<span class="code-prop">$2</span>')
						.replace(/\[([^=]+)/g, '[<span class="code-prop">$1</span>')
						.replace(/\t/g, '&nbsp; &nbsp;')
						.replace(/\s{2}/g, '&nbsp; &nbsp;')
					;
				});
				return	code.join('<br/>');
			});

			ctx.sidebar = {
				items: [
					  { path: '/', text: 'About' }
					, { path: '/started', text: 'Getting started' }
				],
				path: location.path
			};

			ctx.examples = {
				hello: {
					xtpl: [
						'.well {',
						'   h4 | Hello {{ctx.name || "%username%"}}!',
						'   input { type: "text", x-model: ctx.name }',
						'}'
					].join('\n')
				},

				counter: {
					ctx: { cnt: 0 },
					xtpl: [
						'input.btn.btn-success[type="button"] {',
						'   x-click: ctx.counter++;',
						'   value: {{ctx.counter || "Click me"}}',
						'}'
					].join('\n')
				},

				list: {
					xtpl: [
						'form {',
						'	x-submit: ctx.addItem(ctx.newItem);',
						'	input[type="text"][placeholder="Add new item"] {',
						'		x-model: ctx.newItem',
						'		x-autofocus: ctx.newItem === ""',
						'	}',
						'}',
						'',
						'ul.nav.nav-pills.nav-stacked {',
						'	for item in ctx.items {',
						'		li {',
						'			x-click: ctx.selectedItem = item;',
						'			class: { active: item === ctx.selectedItem }',
						'			a[href=""] | {{item}}',
						'		}',
						'	}',
						'}',
						'',
						'div {',
						'	button.btn.btn-small {',
						'		x-click: ctx.sortItems(ctx.SORT_ASC);',
						'		| asc',
						'	}',
						'	| &nbsp; &nbsp;',
						'	button.btn.btn-small {',
						'		x-click: ctx.sortItems(ctx.SORT_DESC);',
						'		| desc',
						'	}',
						'}'
					].join('\n')
				}
			};
		});


		xtpl.ctrl('list', function (ctx){
			// New item model
			ctx.newItem = '';

			// Default items
			ctx.items = ['Alpha', 'Beta', 'Gamma'];

			// Active item index in items
			ctx.activeIdx = 0;

			// Add to items
			ctx.addItem = function (){
				if( ctx.newItem.length > 0 ){
					ctx.items.push(ctx.newItem);
					ctx.newItem = '';
				}
			};

			// @const
			ctx.SORT_ASC = function (a, b){
				return	a == b ? 0 : (a > b ? 1 : -1);
			};

			// @const
			ctx.SORT_DESC = function (a, b){
				return	a == b ? 0 : (a > b ? -1 : 1);
			};

			// Sort items by type
			ctx.sortItems = function (fn){
				ctx.items.sort(fn);
			};
		});

	</script>

</body>
</html>
